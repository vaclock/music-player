!function(n,e){function t(){this.frameTimer=null,this.musicList=[],this.rotateTimer=null,this.controls=document.querySelectorAll(".icon_list li"),this.coverImg=document.querySelector(".cover img"),this.wrap=document.querySelector(".songs_list"),this.musicPauseTime=0,this.pro=e.progress.pro()}t.prototype={init:function(){this.getData("../mock/data.json")},getData:function(t){const i=this;n.ajax({url:t,method:"get",success:function(t){i.musicList=t,e.list.createList(i.wrap,t),i.indexManage=e.Index(0,i.musicList.length),i.index=i.indexManage.index,i.render(i.index),i.loadMusic(i.index),i.musicControl(),i.bindEvent()}})},render:function(t){e.render(this.musicList[t])},rotateImage:function(t=0){const i=this;this.rotateTimer||(t+=this.coverDeg||0,this.rotateTimer=setInterval(function(){t=+t+.2,i.coverImg.style.transform=`rotate(${t}deg)`},16))},stopRotate:function(){clearInterval(this.rotateTimer),this.rotateTimer=null},loadMusic:function(t){this.pro.clear(),this.progressDrag();const i=this;e.music.load(this.musicList[t].audioSrc),this.render(t),this.coverDeg=0,this.stopRotate(),e.list.active(t),e.music.audio.oncanplay=function(){i.duration=e.music.audio.duration,i.pro.renderTotalTime(i.duration)}},onplay:function(){this.controls[2].className="playing",this.rotateImage(0),e.music.status="playing",this.pro.update(e.music.audio)},onpause:function(){e.music.status="pause",this.stopRotate(),this.coverDeg=this.coverImg.style.transform.split("(")[1].slice(0,-4),this.controls[2].className="",this.pro.stop()},musicControl:function(){const i=this;this.controls[1].addEventListener("touchend",function(t){i.index=i.indexManage.prev(),i.loadMusic(i.index),e.music.play(i.onplay.bind(i))}),this.controls[2].addEventListener("touchend",function(){"playing"==e.music.status?e.music.pause(i.onpause.bind(i)):e.music.play(i.onplay.bind(i))}),this.controls[3].addEventListener("touchend",function(){i.index=i.indexManage.next(),i.loadMusic(i.index),e.music.play(i.onplay.bind(i))}),e.music.onend(function(){i.index=i.indexManage.next(),i.loadMusic(i.index),e.music.play(i.onplay.bind(i))})},bindEvent:function(){const i=this;this.controls[4].addEventListener("touchend",function(){e.list.slideUp(i.wrap)}),e.list.listEvent("touchend",function(t){i.index!==t&&(i.index=t,e.list.slideDown(i.wrap),i.loadMusic(i.index),e.music.play(i.onplay.bind(i)))})},progressDrag:function(){const i=this,t=e.progress.drag(document.querySelector(".circle"));t.onstart=function(){i.pro.stop()},t.onmove=function(t){i.pro.move(t);t*=i.duration;i.pro.curTime.innerHTML=i.pro.formatTime(t)},t.onend=function(t){e.music.playTo(t*i.duration),e.music.play(i.onplay.bind(i))}}};const i=new t;i.init()}(window.Zepto,window.player);